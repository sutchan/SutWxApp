锘?!-- 鐠併垹宕熺拠锔藉剰妞ょ敻娼?-->
<view class="container">
  <!-- 閸旂姾娴囨稉顓犲Ц閹?-->
  <view class="loading" wx:if="{{loading}}">
    <text>閸旂姾娴囨稉?..</text>
  </view>

  <!-- 闁挎瑨顕ら悩鑸碘偓?-->
  <view class="error" wx:if="{{error}}">
    <image src="/images/error.svg" class="error-icon"></image>
    <text class="error-text">{{errorMsg}}</text>
    <button class="retry-btn" bindtap="onRetry">闁插秷鐦?/button>
    <button wx:if="{{errorMsg === '鐠囧嘲鍘涢惂璇茬秿'}}" class="login-btn" bindtap="onLogin">閸樿崵娅ヨぐ?/button>
  </view>

  <!-- 鐠併垹宕熺拠锔藉剰閸愬懎顔?-->
  <view class="order-content" wx:if="{{!loading && !error && orderDetail}}">
    <!-- 鐠併垹宕熼悩鑸碘偓浣稿幢閻?-->
    <view class="status-card">
      <view class="status-text" wx:if="{{orderDetail.status === 'pending_payment'}}" style="color: #ff6b81;">{{orderDetail.statusText}}</view>
      <view class="status-text" wx:elif="{{orderDetail.status === 'pending_shipping'}}" style="color: #ff9500;">{{orderDetail.statusText}}</view>
      <view class="status-text" wx:elif="{{orderDetail.status === 'pending_receipt'}}" style="color: #007aff;">{{orderDetail.statusText}}</view>
      <view class="status-text" wx:elif="{{orderDetail.status === 'completed'}}" style="color: #4cd964;">{{orderDetail.statusText}}</view>
      <view class="status-text" wx:else style="color: #999999;">{{orderDetail.statusText}}</view>
    </view>

    <!-- 閺€鎯版彛閸︽澘娼冩穱鈩冧紖 -->
    <view class="address-card" wx:if="{{address}}">
      <view class="address-title">閺€鎯版彛娣団剝浼?/view>
      <view class="address-info">
        <view class="address-user">{{address.receiver}} {{address.phone}}</view>
        <view class="address-detail">{{address.province}}{{address.city}}{{address.district}}{{address.detail}}</view>
      </view>
    </view>

    <!-- 鐠併垹宕熼崯鍡楁惂娣団剝浼?-->
    <view class="products-card">
      <view class="section-title">閸熷棗鎼ф穱鈩冧紖</view>
      <view class="product-list">
        <view class="product-item" wx:for="{{orderDetail.products}}" wx:key="id" bindtap="onProductTap" data-id="{{item.id}}">
          <image class="product-image" src="{{item.image}}" mode="aspectFill"></image>
          <view class="product-info">
            <view class="product-title">{{item.title}}</view>
            <view class="product-bottom">
              <view class="product-price">妤納{item.price}}</view>
              <view class="product-quantity">x{{item.quantity}}</view>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- 鐠併垹宕熸穱鈩冧紖 -->
    <view class="order-info-card">
      <view class="section-title">鐠併垹宕熸穱鈩冧紖</view>
      <view class="info-item">
        <view class="info-label">鐠併垹宕熺紓鏍у娇閿?/view>
        <view class="info-value">{{orderDetail.orderNo}}</view>
      </view>
      <view class="info-item">
        <view class="info-label">娑撳宕熼弮鍫曟？閿?/view>
        <view class="info-value">{{orderDetail.createTime}}</view>
      </view>
      <view class="info-item" wx:if="{{orderDetail.paymentTime}}">
        <view class="info-label">閺€顖欑帛閺冨爼妫块敍?/view>
        <view class="info-value">{{orderDetail.paymentTime}}</view>
      </view>
      <view class="info-item" wx:if="{{orderDetail.shippingTime}}">
        <view class="info-label">閸欐垼鎻ｉ弮鍫曟？閿?/view>
        <view class="info-value">{{orderDetail.shippingTime}}</view>
      </view>
      <view class="info-item" wx:if="{{orderDetail.completeTime}}">
        <view class="info-label">鐎瑰本鍨氶弮鍫曟？閿?/view>
        <view class="info-value">{{orderDetail.completeTime}}</view>
      </view>
      <view class="info-item" wx:if="{{orderDetail.trackingNo}}">
        <view class="info-label">閻椻晜绁﹂崡鏇炲娇閿?/view>
        <view class="info-value">{{orderDetail.trackingNo}}</view>
      </view>
      <view class="info-item" wx:if="{{orderDetail.paymentMethod}}">
        <view class="info-label">閺€顖欑帛閺傜懓绱￠敍?/view>
        <view class="info-value">{{orderDetail.paymentMethod}}</view>
      </view>
      <view class="info-item" wx:if="{{orderDetail.orderRemark}}">
        <view class="info-label">鐠併垹宕熸径鍥ㄦ暈閿?/view>
        <view class="info-value">{{orderDetail.orderRemark}}</view>
      </view>
    </view>

    <!-- 鐠併垹宕熼柌鎴︻杺 -->
    <view class="price-card">
      <view class="price-item">
        <view class="price-label">閸熷棗鎼ч幀璁崇幆閿?/view>
        <view class="price-value">妤納{orderDetail.totalPrice}}</view>
      </view>
      <view class="price-item">
        <view class="price-label">鏉╂劘鍨傞敍?/view>
        <view class="price-value">妤納{orderDetail.freight}}</view>
      </view>
      <view class="price-item" wx:if="{{orderDetail.couponDiscount > 0}}">
        <view class="price-label">娴兼ɑ鍎崚闈╃窗</view>
        <view class="price-value" style="color: #ff4757;">-妤納{orderDetail.couponDiscount}}
          <text class="coupon-name" wx:if="{{orderDetail.couponInfo && orderDetail.couponInfo.name}}">({{orderDetail.couponInfo.name}})</text>
        </view>
      </view>
      <view class="price-item total">
        <view class="price-label">鐎圭偘绮▎鎾呯窗</view>
        <view class="price-value total-price">妤納{orderDetail.finalTotal}}</view>
      </view>
    </view>
  </view>

  <!-- 鎼存洟鍎撮幙宥勭稊閺?-->
  <view class="bottom-bar" wx:if="{{!loading && !error && orderDetail}}">
    <view class="bottom-left">
      <button class="service-btn" bindtap="onContactService">閼辨梻閮寸€广垺婀?/button>
    </view>
    <view class="bottom-right">
      <button 
        class="action-btn secondary" 
        wx:if="{{orderDetail.status === 'pending_payment'}}" 
        bindtap="onCancelOrder"
      >
        閸欐牗绉风拋銏犲礋
      </button>
      <button 
        class="action-btn primary" 
        wx:if="{{orderDetail.status === 'pending_payment'}}" 
        bindtap="onPayOrder"
      >
        閸樼粯鏁禒?      </button>
      <button 
        class="action-btn primary" 
        wx:if="{{orderDetail.status === 'pending_receipt'}}" 
        bindtap="onConfirmReceipt"
      >
        绾喛顓婚弨鎯版彛
      </button>
      <button 
        class="action-btn secondary" 
        wx:if="{{orderDetail.status === 'completed'}}" 
        bindtap="onReviewOrder"
      >
        閸樻槒鐦庢禒?      </button>
    </view>
  </view>
</view>\n