锘?!-- list.wxml - 鐠併垹宕熼崚妤勩€冩い鐢告桨濡剝婢?-->

<view class="order-list-container">
  <!-- 妞ゅ爼鍎寸€佃壈鍩?-->
  <view class="nav-bar">
    <view class="nav-title">閹存垹娈戠拋銏犲礋</view>
  </view>

  <!-- 鐠併垹宕熼悩鑸碘偓浣圭垼缁?-->
  <view class="tabs">
    <view 
      wx:for="{{tabs}}" 
      wx:key="key" 
      class="tab {{activeTab === item.key ? 'active' : ''}}" 
      bindtap="switchTab" 
      data-key="{{item.key}}"
    >
      <text class="tab-title">{{item.title}}</text>
    </view>
  </view>

  <!-- 鐠併垹宕熼崚妤勩€?-->
  <view class="order-list" wx:if="{{!loading && orderList.length > 0}}">
    <view wx:for="{{orderList}}" wx:key="id" class="order-item">
      <!-- 鐠併垹宕熸径鎾劥 -->
      <view class="order-header">
        <view class="order-time">{{item.formatted_created_at}}</view>
        <view class="order-status {{item.status}}">{{item.status_text}}</view>
      </view>
      
      <!-- 鐠併垹宕熼崯鍡楁惂 -->
      <view class="order-goods">
        <view 
          wx:for="{{item.items}}" 
          wx:for-item="goods" 
          wx:for-index="goodsIndex" 
          wx:key="goodsIndex" 
          class="goods-item" 
          bindtap="viewOrderDetail" 
          data-id="{{item.id}}"
        >
          <view class="goods-image">
            <image src="{{goods.product_image}}" mode="aspectFit"></image>
          </view>
          <view class="goods-info">
            <view class="goods-name">{{goods.product_name}}</view>
            <view wx:if="{{goods.specs}}" class="goods-specs">{{goods.specs}}</view>
            <view class="goods-price-quantity">
              <view class="goods-price">妤納{goods.price}}</view>
              <view class="goods-quantity">x{{goods.quantity}}</view>
            </view>
          </view>
        </view>
      </view>
      
      <!-- 鐠併垹宕熼柌鎴︻杺 -->
      <view class="order-amount">
        <text class="amount-label">閸忕湧{item.total_quantity}}娴犺泛鏅㈤崫?閸氬牐顓搁敍?/text>
        <text class="amount-value">妤納{item.total_amount}}</text>
      </view>
      
      <!-- 鐠併垹宕熼幙宥勭稊閹稿鎸?-->
      <view class="order-actions">
        <!-- 瀵板懍绮▎鍓уЦ閹?-->
        <block wx:if="{{item.status === 'pending_payment'}}">
          <button class="btn-secondary" bindtap="cancelOrder" data-id="{{item.id}}">閸欐牗绉风拋銏犲礋</button>
          <button class="btn-primary" bindtap="goToPay" data-order="{{item}}">閸樼粯鏁禒?/button>
        </block>
        
        <!-- 瀵板懎褰傜拹褏濮搁幀?-->
        <block wx:elif="{{item.status === 'pending_shipment'}}">
          <button class="btn-secondary" bindtap="viewOrderDetail" data-id="{{item.id}}">閺屻儳婀呯拠锔藉剰</button>
        </block>
        
        <!-- 瀵板懏鏁圭拹褏濮搁幀?-->
        <block wx:elif="{{item.status === 'pending_receipt'}}">
          <button class="btn-secondary" bindtap="viewLogistics" data-id="{{item.id}}">閺屻儳婀呴悧鈺傜ウ</button>
          <button class="btn-primary" bindtap="confirmReceipt" data-id="{{item.id}}">绾喛顓婚弨鎯版彛</button>
        </block>
        
        <!-- 瀹告彃鐣幋鎰Ц閹?-->
        <block wx:elif="{{item.status === 'completed'}}">
          <button class="btn-secondary" bindtap="buyAgain" data-order="{{item}}">閸愬秵顐肩拹顓濇嫳</button>
          <button class="btn-primary" bindtap="reviewOrder" data-id="{{item.id}}">鐠囧嫪鐜拋銏犲礋</button>
        </block>
        
        <!-- 瀹告彃褰囧☉鍫㈠Ц閹?-->
        <block wx:elif="{{item.status === 'cancelled'}}">
          <button class="btn-secondary" bindtap="deleteOrder" data-id="{{item.id}}">閸掔娀娅庣拋銏犲礋</button>
          <button class="btn-primary" bindtap="buyAgain" data-order="{{item}}">閸愬秵顐肩拹顓濇嫳</button>
        </block>
        
        <!-- 闁偓濞嗗彞鑵戦悩鑸碘偓?-->
        <block wx:elif="{{item.status === 'refunding'}}">
          <button class="btn-secondary" bindtap="viewOrderDetail" data-id="{{item.id}}">閺屻儳婀呯拠锔藉剰</button>
        </block>
        
        <!-- 姒涙顓婚悩鑸碘偓?-->
        <block wx:else>
          <button class="btn-secondary" bindtap="viewOrderDetail" data-id="{{item.id}}">閺屻儳婀呯拠锔藉剰</button>
        </block>
      </view>
    </view>
    
    <!-- 閸旂姾娴囬弴鏉戭樋 -->
    <view class="load-more" wx:if="{{hasMore}}">
      <view class="loading" wx:if="{{loadingMore}}">
        <text>閸旂姾娴囨稉?..</text>
      </view>
      <view class="load-more-text" wx:else bindtap="loadMoreOrders">閻愮懓鍤崝鐘烘祰閺囨潙顦?/view>
    </view>
    
    <!-- 濞屸剝婀侀弴鏉戭樋閺佺増宓?-->
    <view class="no-more" wx:if="{{!hasMore && orderList.length > 0}}">
      <text>濞屸剝婀侀弴鏉戭樋閺佺増宓佹禍?/text>
    </view>
  </view>

  <!-- 閸旂姾娴囨稉顓犲Ц閹?-->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading">
      <text>閸旂姾娴囨稉?..</text>
    </view>
  </view>

  <!-- 缁岃櫣濮搁幀?-->
  <view class="empty-container" wx:if="{{!loading && empty}}">
    <view class="empty-icon">
      <image src="/assets/images/empty-order.png" mode="aspectFit"></image>
    </view>
    <view class="empty-text">閺嗗倹妫ょ拋銏犲礋</view>
    <button class="btn-primary" bindtap="backToHome">閸樺鈧盯鈧?/button>
  </view>
</view>\n