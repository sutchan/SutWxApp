<!-- 鍒嗛攢璇︽儏椤甸潰 -->
<view class="distribute-detail-page">
  <!-- 加载中-->
  <view class="loading-container" wx:if="{{loading}}">
    <text>加载中..</text>
  </view>

  <!-- 閿欒鐘舵€?-->
  <view class="error-container" wx:elif="{{error}}">
    <image src="../../images/error.svg" class="error-image" />
    <text class="error-text">鍔犺浇澶辫触</text>
    <button class="retry-btn" bindtap="getDistributeDetail">閲嶈瘯</button>
  </view>

  <!-- 璇︽儏鍐呭 -->
  <view class="detail-content" wx:else>
    <!-- 鍒嗛攢鍩烘湰淇℃伅 -->
    <view class="detail-section">
      <view class="section-header">
        <text class="section-title">鍩烘湰淇℃伅</text>
      </view>
      <view class="section-content">
        <view class="info-item">
          <text class="info-label">鍒嗛攢ID</text>
          <text class="info-value">{{distributeDetail.id}}</text>
        </view>
        <view class="info-item">
          <text class="info-label">鏍囬</text>
          <text class="info-value">{{distributeDetail.title}}</text>
        </view>
        <view class="info-item">
          <text class="info-label">绫诲瀷</text>
          <text class="info-value">{{distributeDetail.type === 'product' ? '鍟嗗搧' : '鏂囩珷'}}</text>
        </view>
        <view class="info-item">
          <text class="info-label">鐘舵€?/text>
          <text class="info-value" wx:if="{{distributeDetail.status === 'pending'}}">
            <text class="status-pending">寰呭鏍?/text>
          </text>
          <text class="info-value" wx:elif="{{distributeDetail.status === 'approved'}}">
            <text class="status-approved">宸查€氳繃</text>
          </text>
          <text class="info-value" wx:elif="{{distributeDetail.status === 'rejected'}}">
            <text class="status-rejected">宸查┏鍥?/text>
          </text>
          <text class="info-value" wx:else>
            <text class="status-deleted">宸插垹闄?/text>
          </text>
        </view>
        <view class="info-item">
          <text class="info-label">鍒涘缓鏃堕棿</text>
          <text class="info-value">{{distributeDetail.createTime}}</text>
        </view>
        <view class="info-item">
          <text class="info-label">鏇存柊鏃堕棿</text>
          <text class="info-value">{{distributeDetail.updateTime}}</text>
        </view>
      </view>
    </view>

    <!-- 鍒嗛攢鎻忚堪 -->
    <view class="detail-section">
      <view class="section-header">
        <text class="section-title">鎻忚堪</text>
      </view>
      <view class="section-content">
        <text class="description-text">{{distributeDetail.description}}</text>
      </view>
    </view>

    <!-- 鍒嗛攢鍏冩暟鎹?-->
    <view class="detail-section" wx:if="{{distributeDetail.metadata}}">
      <view class="section-header">
        <text class="section-title">鍏冩暟鎹?/text>
      </view>
      <view class="section-content">
        <view class="info-item" wx:for="{{distributeDetail.metadata}}" wx:key="key">
          <text class="info-label">{{item.key}}</text>
          <text class="info-value">{{item.value}}</text>
        </view>
      </view>
    </view>

    <!-- 瀹℃牳璁板綍 -->
    <view class="detail-section" wx:if="{{distributeDetail.auditLogs && distributeDetail.auditLogs.length > 0}}">
      <view class="section-header">
        <text class="section-title">瀹℃牳璁板綍</text>
      </view>
      <view class="section-content">
        <view class="audit-log-item" wx:for="{{distributeDetail.auditLogs}}" wx:key="id">
          <view class="log-header">
            <text class="log-operator">{{item.operator}}</text>
            <text class="log-time">{{item.createTime}}</text>
          </view>
          <view class="log-content">
            <text class="log-action">{{item.action === 'approve' ? '瀹℃牳閫氳繃' : item.action === 'reject' ? '椹冲洖' : '鍒犻櫎'}}</text>
            <text class="log-reason" wx:if="{{item.reason}}">鍘熷洜锛歿{item.reason}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- 鎿嶄綔鎸夐挳 -->
    <view class="action-section">
      <view class="action-buttons" wx:if="{{distributeDetail.status === 'pending'}}">
        <button class="action-btn approve-btn" bindtap="approveDistribute">
          瀹℃牳閫氳繃
        </button>
        <button class="action-btn reject-btn" bindtap="rejectDistribute">
          椹冲洖
        </button>
        <button class="action-btn delete-btn" bindtap="deleteDistribute">
          鍒犻櫎
        </button>
      </view>
      <view class="action-buttons" wx:elif="{{distributeDetail.status === 'approved' || distributeDetail.status === 'rejected'}}">
        <button class="action-btn delete-btn" bindtap="deleteDistribute">
          鍒犻櫎
        </button>
      </view>
      <button class="action-btn back-btn" bindtap="goBack">
        杩斿洖鍒楄〃
      </button>
    </view>
  </view>
</view>
