锘?!-- pay.wxml - 閺€顖欑帛妞ょ敻娼板Ο鈩冩緲 -->

<view class="payment-container">
  <!-- 妞ゅ爼鍎寸€佃壈鍩?-->
  <view class="nav-bar">
    <view class="nav-left" bindtap="cancelPayment">
      <text>閸欐牗绉?/text>
    </view>
    <view class="nav-title">鐠併垹宕熼弨顖欑帛</view>
    <view class="nav-right"></view>
  </view>

  <!-- 閺€顖欑帛閻樿埖鈧椒璐熺粵澶婄窡閺€顖欑帛 -->
  <view wx:if="{{payStatus === 'pending'}}">
    <!-- 鐠併垹宕熸穱鈩冧紖 -->
    <view class="order-info">
      <view class="amount-section">
        <view class="amount-label">閺€顖欑帛闁叉垿顤?/view>
        <view class="amount-value">妤納{amount}}</view>
      </view>
      
      <view class="order-no-section" wx:if="{{orderDetail}}">
        <view class="order-no-label">鐠併垹宕熺紓鏍у娇</view>
        <view class="order-no-value">{{orderDetail.order_no}}</view>
      </view>
      
      <view class="countdown-section">
        <view class="countdown-label">鐠囧嘲婀?/view>
        <view class="countdown-value">{{countdownText}}</view>
        <view class="countdown-label">閸愬懎鐣幋鎰暜娴?/view>
      </view>
    </view>

    <!-- 閺€顖欑帛閺傜懓绱?-->
    <view class="payment-methods">
      <view class="section-title">闁瀚ㄩ弨顖欑帛閺傜懓绱?/view>
      
      <!-- 瀵邦喕淇婇弨顖欑帛 -->
      <view 
        class="payment-method {{payMethod === 'wechat' ? 'selected' : ''}}" 
        bindtap="selectPayMethod" 
        data-method="wechat"
      >
        <view class="payment-icon">
          <image src="/assets/images/wechat-pay.png" mode="aspectFit"></image>
        </view>
        <view class="payment-name">瀵邦喕淇婇弨顖欑帛</view>
        <view class="payment-check {{payMethod === 'wechat' ? 'selected' : ''}}">
          <image wx:if="{{payMethod === 'wechat'}}" src="/assets/images/check.png" mode="aspectFit"></image>
        </view>
      </view>
      
      <!-- 閺€顖欑帛鐎?-->
      <view 
        class="payment-method {{payMethod === 'alipay' ? 'selected' : ''}}" 
        bindtap="selectPayMethod" 
        data-method="alipay"
      >
        <view class="payment-icon">
          <image src="/assets/images/alipay.png" mode="aspectFit"></image>
        </view>
        <view class="payment-name">閺€顖欑帛鐎?/view>
        <view class="payment-check {{payMethod === 'alipay' ? 'selected' : ''}}">
          <image wx:if="{{payMethod === 'alipay'}}" src="/assets/images/check.png" mode="aspectFit"></image>
        </view>
      </view>
    </view>

    <!-- 鐠併垹宕熺拠锔藉剰 -->
    <view class="order-detail-section" wx:if="{{orderDetail}}">
      <view class="section-title">鐠併垹宕熸穱鈩冧紖</view>
      <view class="order-detail-content">
        <view class="detail-item">
          <view class="detail-label">閸掓稑缂撻弮鍫曟？</view>
          <view class="detail-value">{{orderDetail.created_at}}</view>
        </view>
        <view class="detail-item">
          <view class="detail-label">閺€顖欑帛閺傜懓绱?/view>
          <view class="detail-value">
            <text wx:if="{{payMethod === 'wechat'}}">瀵邦喕淇婇弨顖欑帛</text>
            <text wx:elif="{{payMethod === 'alipay'}}">閺€顖欑帛鐎?/text>
            <text wx:else>閺堫亪鈧瀚?/text>
          </view>
        </view>
        <view class="detail-item" wx:if="{{orderDetail.shipping_address}}">
          <view class="detail-label">閺€鎯版彛閸︽澘娼?/view>
          <view class="detail-value">{{orderDetail.shipping_address.consignee}} {{orderDetail.shipping_address.phone}}</view>
          <view class="detail-value address-detail">{{orderDetail.shipping_address.province}}{{orderDetail.shipping_address.city}}{{orderDetail.shipping_address.district}}{{orderDetail.shipping_address.address}}</view>
        </view>
      </view>
    </view>
  </view>

  <!-- 閺€顖欑帛閻樿埖鈧椒璐熼弨顖欑帛閹存劕濮?-->
  <view wx:elif="{{payStatus === 'success'}}">
    <view class="pay-result success">
      <view class="result-icon">
        <image src="/assets/images/success.png" mode="aspectFit"></image>
      </view>
      <view class="result-title">閺€顖欑帛閹存劕濮?/view>
      <view class="result-amount">妤納{amount}}</view>
      <view class="result-order" wx:if="{{payResult.orderNo}}">鐠併垹宕熼崣? {{payResult.orderNo}}</view>
      
      <view class="result-buttons">
        <button class="btn-primary" bindtap="viewOrderDetail">閺屻儳婀呯拋銏犲礋</button>
        <button class="btn-secondary" bindtap="backToHome">鏉╂柨娲栨＃鏍€?/button>
      </view>
    </view>
  </view>

  <!-- 閺€顖欑帛閻樿埖鈧椒璐熼弨顖欑帛婢惰精瑙?-->
  <view wx:elif="{{payStatus === 'failed'}}">
    <view class="pay-result failed">
      <view class="result-icon">
        <image src="/assets/images/failed.png" mode="aspectFit"></image>
      </view>
      <view class="result-title">閺€顖欑帛婢惰精瑙?/view>
      <view class="result-message">{{payResult.message}}</view>
      <view class="result-order" wx:if="{{payResult.orderNo}}">鐠併垹宕熼崣? {{payResult.orderNo}}</view>
      
      <view class="result-buttons">
        <button class="btn-primary" bindtap="retryPayment">闁插秵鏌婇弨顖欑帛</button>
        <button class="btn-secondary" bindtap="viewOrderDetail">閺屻儳婀呯拋銏犲礋</button>
      </view>
    </view>
  </view>

  <!-- 閺€顖欑帛閹稿鎸?-->
  <view class="bottom-bar" wx:if="{{payStatus === 'pending'}}">
    <view class="bottom-amount">
      <text>閺€顖欑帛闁叉垿顤傞敍?/text>
      <text class="amount-value">妤納{amount}}</text>
    </view>
    <button class="pay-btn" bindtap="initiatePayment" loading="{{loading}}">绾喛顓婚弨顖欑帛</button>
  </view>
</view>\n