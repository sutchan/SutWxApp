<!--
  鏂囦欢鍚?following.wxml
  鐗堟湰鍙?1.0.0
  鏇存柊鏃ユ湡: 2025-11-23
  鎻忚堪: 鍏虫敞涓庣矇涓濋〉闈?-->
<!-- 涓诲鍣?-->
<view class="container">
  <!-- 鎼滅储鏍?-->
  <view class="search-bar">
    <view class="search-input-wrapper">
      <input class="search-input" 
             placeholder="鎼滅储鐢ㄦ埛" 
             value="{{searchKeyword}}" 
             bindinput="onSearchInput" 
             bindconfirm="onSearch" />
      <view class="search-icon" bindtap="onSearch"></view>
      <view class="clear-icon {{searchKeyword ? '' : 'hidden'}}" bindtap="clearSearch"></view>
    </view>
  </view>

  <!-- 鏍囩鏍?-->
  <view class="tab-bar">
    <view wx:for="{{tabs}}" 
          wx:key="index" 
          class="tab-item {{activeTab === index ? 'active' : ''}}" 
          data-index="{{index}}" 
          bindtap="onTabChange">
      {{item}}
    </view>
  </view>

  <!-- 缂栬緫鏍?-->
  <view class="edit-bar" wx:if="{{editMode}}">
    <view class="select-all" bindtap="toggleSelectAll">
      <view class="checkbox {{selectedItems.length === (activeTab === 0 ? followingList.length : followersList.length) ? 'checked' : ''}}"></view>
      <text>鍏ㄩ€?/text>
    </view>
    <view class="edit-actions">
      <text class="cancel-btn" bindtap="toggleEditMode">鍙栨秷</text>
      <text class="action-btn" bindtap="unfollowUsers">鍙栨秷鍏虫敞({{selectedItems.length}})</text>
    </view>
  </view>

  <!-- 鍐呭鍖哄煙 -->
  <view class="content">
    <!-- 鎼滅储缁撴灉 -->
    <view wx:if="{{showSearchResults}}" class="search-results">
      <view class="list-header">
        <text>鎼滅储缁撴灉</text>
      </view>
      <view class="user-list">
        <view wx:for="{{searchResults}}" 
              wx:key="id" 
              class="user-item" 
              data-id="{{item.id}}" 
              bindtap="viewUserDetail">
          <view class="user-avatar">
            <image src="{{item.avatar || '/images/default-avatar.png'}}" mode="aspectFill"></image>
          </view>
          <view class="user-info">
            <view class="user-name">{{item.name}}</view>
            <view class="user-desc">{{item.description || '杩欎釜浜哄緢绁炵锛屼粈涔堥兘娌℃湁鐣欎笅'}}</view>
          </view>
          <view class="follow-btn" 
                data-id="{{item.id}}" 
                catchtap="followUser">鍏虫敞</view>
        </view>
      </view>
      <view wx:if="{{searchResults.length === 0}}" class="empty-state">
        <image src="/images/empty.svg" class="empty-icon"></image>
        <text>娌℃湁鎵惧埌鍖归厤鐨勭敤鎴?/text>
      </view>
    </view>

    <!-- 鎴戝叧娉ㄧ殑 -->
    <view wx:if="{{!showSearchResults && activeTab === 0}}" class="following-list">
      <view class="list-header">
        <text>鎴戝叧娉ㄧ殑</text>
        <text class="edit-btn" bindtap="toggleEditMode">{{editMode ? '瀹屾垚' : '缂栬緫'}}</text>
      </view>
      <view class="user-list">
        <view wx:for="{{followingList}}" 
              wx:key="id" 
              class="user-item {{editMode ? 'edit-mode' : ''}}" 
              data-id="{{item.id}}" 
              bindtap="{{editMode ? 'onSelectItem' : 'viewUserDetail'}}">
          <view wx:if="{{editMode}}" class="checkbox {{selectedItems.indexOf(item.id) > -1 ? 'checked' : ''}}"></view>
          <view class="user-avatar">
            <image src="{{item.avatar || '/images/default-avatar.png'}}" mode="aspectFill"></image>
          </view>
          <view class="user-info">
            <view class="user-name">{{item.name}}</view>
            <view class="user-desc">{{item.description || '杩欎釜浜哄緢绁炵锛屼粈涔堥兘娌℃湁鐣欎笅'}}</view>
          </view>
          <view wx:if="{{!editMode}}" class="follow-status">宸插叧娉?/view>
        </view>
      </view>
      
      <!-- 绌虹姸鎬?-->
      <view wx:if="{{isEmpty && followingList.length === 0}}" class="empty-state">
        <image src="/images/empty.svg" class="empty-icon"></image>
        <text>浣犺繕娌℃湁鍏虫敞浠讳綍浜?/text>
        <text class="empty-tip">鍘诲彂鐜版洿澶氭湁瓒ｇ殑鐢ㄦ埛鍚?/text>
      </view>
    </view>

    <!-- 鍏虫敞鎴戠殑 -->
    <view wx:if="{{!showSearchResults && activeTab === 1}}" class="followers-list">
      <view class="list-header">
        <text>鍏虫敞鎴戠殑</text>
      </view>
      <view class="user-list">
        <view wx:for="{{followersList}}" 
              wx:key="id" 
              class="user-item" 
              data-id="{{item.id}}" 
              bindtap="viewUserDetail">
          <view class="user-avatar">
            <image src="{{item.avatar || '/images/default-avatar.png'}}" mode="aspectFill"></image>
          </view>
          <view class="user-info">
            <view class="user-name">{{item.name}}</view>
            <view class="user-desc">{{item.description || '杩欎釜浜哄緢绁炵锛屼粈涔堥兘娌℃湁鐣欎笅'}}</view>
          </view>
          <view class="follow-btn" 
                data-id="{{item.id}}" 
                catchtap="followUser">鍏虫敞</view>
        </view>
      </view>
      
      <!-- 绌虹姸鎬?-->
      <view wx:if="{{isEmpty && followersList.length === 0}}" class="empty-state">
        <image src="/images/empty.svg" class="empty-icon"></image>
        <text>杩樻病鏈変汉鍏虫敞浣?/text>
        <text class="empty-tip">鍒嗕韩鏇村绮惧僵鍐呭锛屽惛寮曠矇涓濆叧娉?/text>
      </view>
    </view>

    <!-- 鎺ㄨ崘鍏虫敞 -->
    <view wx:if="{{!showSearchResults && !loading && !isEmpty && followingList.length === 0}}">
      <view class="recommended-header">
        <text>鎺ㄨ崘鍏虫敞</text>
        <text class="refresh-btn" bindtap="refreshRecommendedUsers">鎹竴鎵?/text>
      </view>
      <view class="user-list">
        <view wx:for="{{recommendedUsers}}" 
              wx:key="id" 
              class="user-item" 
              data-id="{{item.id}}" 
              bindtap="viewUserDetail">
          <view class="user-avatar">
            <image src="{{item.avatar || '/images/default-avatar.png'}}" mode="aspectFill"></image>
          </view>
          <view class="user-info">
            <view class="user-name">{{item.name}}</view>
            <view class="user-desc">{{item.description || '杩欎釜浜哄緢绁炵锛屼粈涔堥兘娌℃湁鐣欎笅'}}</view>
          </view>
          <view class="follow-btn" 
                data-id="{{item.id}}" 
                catchtap="followUser">鍏虫敞</view>
        </view>
      </view>
      <view wx:if="{{recommendedLoading}}" class="loading-state">
        <view class="loading-spinner"></view>
        <text>鍔犺浇涓?..</text>
      </view>
      <view wx:if="{{!recommendedLoading && recommendedUsers.length === 0}}" class="empty-state">
        <image src="/images/empty.svg" class="empty-icon"></image>
        <text>鏆傛椂娌℃湁鎺ㄨ崘鐢ㄦ埛</text>
      </view>
    </view>

    <!-- 鍔犺浇鐘舵€?->
    <view wx:if="{{loading}}" class="loading-state">
      <view class="loading-spinner"></view>
      <text>鍔犺浇涓?..</text>
    </view>

    <!-- 娌℃湁鏇村鏁版嵁 -->
    <view wx:if="{{noMoreData && !isEmpty && !loading && !showSearchResults}}" class="no-more-data">
      <text>娌℃湁鏇村鏁版嵁浜?/text>
    </view>
  </view>
</view>\n