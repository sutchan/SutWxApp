/**
 * 鏂囦欢鍚? favorites.wxml
 * 鐗堟湰鍙? 1.0.0
 * 鏇存柊鏃ユ湡: 2025-11-23
 * 鎻忚堪: favorites 妞ょ敻娼扮紒鎾寸€弬鍥︽
 */
<view class="container">
  <!-- 閺嶅洨顒烽崚鍥ㄥ床 -->
  <view class="tabs">
    <view class="tabs-item {{activeTab === index ? 'active' : ''}}" 
          wx:for="{{tabs}}" 
          wx:key="index"
          data-index="{{index}}"
          bindtap="onTabChange">
      {{item}}
    </view>
  </view>

  <!-- 閸熷棗鎼ч弨鎯版閸掓銆?-->
  <view class="content" wx:if="{{activeTab === 0}}">
    <view class="list-header">
      <text class="count">閸忕湧{productFavorites.length}}娴犺泛鏅㈤崫?/text>
      <text class="edit-btn" bindtap="onEditMode" wx:if="{{!editMode && productFavorites.length > 0}}">缁狅紕鎮?/text>
    </view>
    
    <!-- 缂傛牞绶Ο鈥崇础閹垮秳缍旈弽?-->
    <view class="edit-bar" wx:if="{{editMode}}">
      <view class="select-all" bindtap="onSelectAll">
        <icon type="{{selectAll.product ? 'success' : 'circle'}}" size="18"/>
        <text>閸忋劑鈧?/text>
      </view>
      <view class="edit-actions">
        <text class="cancel-btn" bindtap="onCancelEdit">閸欐牗绉?/text>
        <text class="delete-btn" bindtap="onDeleteSelected">閸掔娀娅?/text>
      </view>
    </view>
    
    <!-- 閸熷棗鎼ч崚妤勩€?-->
    <view class="product-list" wx:if="{{productFavorites.length > 0}}">
      <view class="product-item" 
            wx:for="{{productFavorites}}" 
            wx:key="id"
            data-id="{{item.id}}"
            bindtap="onProductTap">
        <view class="select-box" wx:if="{{editMode}}" 
              data-id="{{item.id}}"
              data-type="product"
              bindtap="onSelectItem"
              catchtap="true">
          <icon type="{{selectedItems.product.indexOf(item.id) > -1 ? 'success' : 'circle'}}" size="18"/>
        </view>
        <image class="product-image" src="{{item.image}}" mode="aspectFill"></image>
        <view class="product-info">
          <view class="product-name">{{item.name}}</view>
          <view class="product-price">
            <text class="current-price">楼{{item.price}}</text>
            <text class="original-price" wx:if="{{item.originalPrice > item.price}}">楼{{item.originalPrice}}</text>
          </view>
          <view class="product-meta">
            <text class="sales">瀹告彃鏁瓄{item.sales}}娴?/text>
            <text class="collect-time">{{item.collectTime}}閺€鎯版</text>
          </view>
        </view>
      </view>
    </view>
    
    <!-- 缁岃櫣濮搁幀?-->
    <view class="empty-state" wx:if="{{productFavorites.length === 0 && !loading}}">
      <image class="empty-icon" src="/images/empty/empty-favorite.png"></image>
      <text class="empty-text">閺嗗倹妫ら弨鎯版閸熷棗鎼?/text>
      <button class="empty-btn" bindtap="goToHome">閸樺鈧盯鈧?/button>
    </view>
  </view>

  <!-- 閺傚洨鐝烽弨鎯版閸掓銆?-->
  <view class="content" wx:if="{{activeTab === 1}}">
    <view class="list-header">
      <text class="count">閸忕湧{articleFavorites.length}}缁″洦鏋冪粩?/text>
      <text class="edit-btn" bindtap="onEditMode" wx:if="{{!editMode && articleFavorites.length > 0}}">缁狅紕鎮?/text>
    </view>
    
    <!-- 缂傛牞绶Ο鈥崇础閹垮秳缍旈弽?-->
    <view class="edit-bar" wx:if="{{editMode}}">
      <view class="select-all" bindtap="onSelectAll">
        <icon type="{{selectAll.article ? 'success' : 'circle'}}" size="18"/>
        <text>閸忋劑鈧?/text>
      </view>
      <view class="edit-actions">
        <text class="cancel-btn" bindtap="onCancelEdit">閸欐牗绉?/text>
        <text class="delete-btn" bindtap="onDeleteSelected">閸掔娀娅?/text>
      </view>
    </view>
    
    <!-- 閺傚洨鐝烽崚妤勩€?-->
    <view class="article-list" wx:if="{{articleFavorites.length > 0}}">
      <view class="article-item" 
            wx:for="{{articleFavorites}}" 
            wx:key="id"
            data-id="{{item.id}}"
            bindtap="onArticleTap">
        <view class="select-box" wx:if="{{editMode}}" 
              data-id="{{item.id}}"
              data-type="article"
              bindtap="onSelectItem"
              catchtap="true">
          <icon type="{{selectedItems.article.indexOf(item.id) > -1 ? 'success' : 'circle'}}" size="18"/>
        </view>
        <image class="article-image" src="{{item.image}}" mode="aspectFill"></image>
        <view class="article-info">
          <view class="article-title">{{item.title}}</view>
          <view class="article-summary">{{item.summary}}</view>
          <view class="article-meta">
            <text class="author">{{item.author}}</text>
            <text class="publish-time">{{item.publishTime}}</text>
            <text class="read-count">{{item.readCount}}闂冨懓顕?/text>
          </view>
          <view class="collect-time">{{item.collectTime}}閺€鎯版</view>
        </view>
      </view>
    </view>
    
    <!-- 缁岃櫣濮搁幀?-->
    <view class="empty-state" wx:if="{{articleFavorites.length === 0 && !loading}}">
      <image class="empty-icon" src="/images/empty/empty-favorite.png"></image>
      <text class="empty-text">閺嗗倹妫ら弨鎯版閺傚洨鐝?/text>
      <button class="empty-btn" bindtap="goToArticle">閸樿崵婀呴惇?/button>
    </view>
  </view>

  <!-- 鍔犺浇鐘舵€?->
  <view class="loading" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <text>鍔犺浇涓?.</text>
  </view>

  <!-- 濞屸剝婀侀弴鏉戭樋閺佺増宓?-->
  <view class="no-more" wx:if="{{!hasMore[activeTab === 0 ? 'product' : 'article'] && (activeTab === 0 ? productFavorites : articleFavorites).length > 0}}">
    <text>濞屸剝婀侀弴鏉戭樋娴?/text>
  </view>
</view>
