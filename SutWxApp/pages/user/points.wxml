锘?!-- 閻劍鍩涚粔顖氬瀻妞ょ敻娼?-->
<view class="points-container">
  <!-- 缁夘垰鍨庢穱鈩冧紖閸楋紕澧?-->
  <view class="points-card" wx:if="{{!loading && !error}}">
    <view class="points-header">
      <view class="points-total">
        <text class="points-number">{{totalPoints || 0}}</text>
        <text class="points-unit">缁夘垰鍨?/text>
      </view>
      <view class="points-actions">
        <button class="rules-button" bindtap="navigateToPointsRules" aria-label="閺屻儳婀呯粔顖氬瀻鐟欏嫬鍨?>
          缁夘垰鍨庣憴鍕灟
          <image class="arrow-icon" src="/images/arrow-right.svg" mode="aspectFit"></image>
        </button>
      </view>
    </view>
    
    <!-- 缁夘垰鍨庣拠锔藉剰娣団剝浼?-->
    <view class="points-details">
      <view class="point-detail-item">
        <text class="point-detail-label">閸欘垳鏁ょ粔顖氬瀻</text>
        <text class="point-detail-value">{{availablePoints || 0}}</text>
      </view>
      <view class="point-detail-item">
        <text class="point-detail-label">瀵板懐鏁撻弫鍫⑿濋崚?/text>
        <text class="point-detail-value">{{pendingPoints || 0}}</text>
      </view>
      <view class="point-detail-item">
        <text class="point-detail-label">閸楀啿鐨㈡潻鍥ㄦ埂</text>
        <text class="point-detail-value">{{expiringPoints || 0}}</text>
      </view>
    </view>
    
    <!-- 缁夘垰鍨庨幙宥勭稊閹稿鎸崇紒?-->
    <view class="points-operations">
      <button class="operation-button" bindtap="navigateToSignIn" aria-label="濮ｅ繑妫╃粵鎯у煂">
        <image class="operation-icon" src="/images/check-in.svg" mode="aspectFit"></image>
        <text class="operation-text">濮ｅ繑妫╃粵鎯у煂</text>
      </button>
      <button class="operation-button" bindtap="navigateToPointsMall" aria-label="缁夘垰鍨庨崯鍡楃厔">
        <image class="operation-icon" src="/images/shopping.svg" mode="aspectFit"></image>
        <text class="operation-text">缁夘垰鍨庨崯鍡楃厔</text>
      </button>
      <button class="operation-button" bindtap="navigateToPointsTasks" aria-label="缁夘垰鍨庢禒璇插">
        <image class="operation-icon" src="/images/tasks.svg" mode="aspectFit"></image>
        <text class="operation-text">缁夘垰鍨庢禒璇插</text>
      </button>
      <button class="operation-button" bindtap="navigateToExchangeRecords" aria-label="閸忔垶宕茬拋鏉跨秿">
        <image class="operation-icon" src="/images/exchange.svg" mode="aspectFit"></image>
        <text class="operation-text">閸忔垶宕茬拋鏉跨秿</text>
      </button>
    </view>
  </view>

  <!-- 缁夘垰鍨庨崢鍡楀蕉鐠佹澘缍?-->
  <view class="history-section" wx:if="{{pointsHistory.length > 0}}">
    <view class="history-header">
      <text class="history-title">缁夘垰鍨庣拋鏉跨秿</text>
      <button class="filter-button" bindtap="showFilterOptions" aria-label="缁涙盯鈧?>
        缁涙盯鈧?        <image class="filter-icon" src="/images/filter.svg" mode="aspectFit"></image>
      </button>
    </view>
    
    <view class="history-list">
      <view 
        wx:for="{{pointsHistory}}" 
        wx:key="id"
        class="history-item"
        aria-label="缁夘垰鍨庣拋鏉跨秿閿涙{item.description || ''}}, {{item.points > 0 ? '+' : ''}}{{item.points}}缁夘垰鍨?>
        <view class="history-info">
          <text class="history-description">{{item.description || '閺堫亞鐓￠幙宥勭稊'}}</text>
          <text class="history-source">{{item.source || ''}}</text>
          <text class="history-time">{{formatTime(item.createdAt) || ''}}</text>
        </view>
        <text class="history-points {{item.points > 0 ? 'points-increase' : 'points-decrease'}}">
          {{item.points > 0 ? '+' : ''}}{{item.points}}
        </text>
      </view>
    </view>
  </view>

  <!-- 閸旂姾娴囬弴鏉戭樋 -->
  <view class="loading-more" wx:if="{{loading && pointsHistory.length > 0}}">
    <text class="loading-more-text">閸旂姾娴囨稉?..</text>
  </view>

  <!-- 濞屸剝婀侀弴鏉戭樋閺佺増宓?-->
  <view class="no-more" wx:if="{{!loading && pointsHistory.length > 0 && !hasMore}}">
    <text class="no-more-text">濞屸剝婀侀弴鏉戭樋鐠佹澘缍嶆禍?/text>
  </view>

  <!-- 缁岃櫣濮搁幀?-->
  <view class="empty" wx:if="{{!loading && pointsHistory.length === 0 && !error}}">
    <image src="/images/empty.svg" mode="aspectFit" class="empty-icon"></image>
    <text class="empty-text">閺嗗倹妫ょ粔顖氬瀻鐠佹澘缍?/text>
  </view>

  <!-- 閸旂姾娴囬悩鑸碘偓?-->
  <view class="loading-container" wx:if="{{loading && pointsHistory.length === 0}}">
    <view class="loading"></view>
    <text class="loading-text">閸旂姾娴囨稉?..</text>
  </view>

  <!-- 闁挎瑨顕ら幓鎰仛 -->
  <view class="error-container" wx:if="{{error}}">
    <image src="/images/error.svg" class="error-icon"></image>
    <text class="error-text">閸旂姾娴囨径杈Е閿涘矁顕柌宥堢槸</text>
    <button class="retry-button" bindtap="retryLoad">闁插秷鐦?/button>
  </view>
  
  <!-- 缁涙盯鈧鑴婄粣?-->
  <view class="filter-modal" wx:if="{{showFilterModal}}">
    <view class="filter-content">
      <view class="filter-header">
        <text class="filter-title">缁涙盯鈧袧閸掑棜顔囪ぐ?/text>
        <button class="close-button" bindtap="hideFilterOptions">閸忔娊妫?/button>
      </view>
      <view class="filter-body">
        <view class="filter-item">
          <text class="filter-label">鐠佹澘缍嶇猾璇茬€?/text>
          <radio-group class="radio-group" bindchange="onFilterTypeChange">
            <label class="radio-item">
              <radio value="all" checked="{{filterType === 'all'}}"></radio>
              <text>閸忋劑鍎?/text>
            </label>
            <label class="radio-item">
              <radio value="gain" checked="{{filterType === 'gain'}}"></radio>
              <text>缁夘垰鍨庨懢宄扮繁</text>
            </label>
            <label class="radio-item">
              <radio value="use" checked="{{filterType === 'use'}}"></radio>
              <text>缁夘垰鍨庢担璺ㄦ暏</text>
            </label>
          </radio-group>
        </view>
      </view>
      <view class="filter-footer">
        <button class="apply-filter-button" bindtap="applyFilter">鎼存梻鏁ょ粵娑⑩偓?/button>
      </view>
    </view>
  </view>
</view>\n