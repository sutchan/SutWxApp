/**
 * 鏂囦欢鍚? pointsTasks.wxml
 * 鐗堟湰鍙? 1.0.0
 * 鏇存柊鏃ユ湡: 2025-11-23
 * 鎻忚堪: pointsTasks 妞ょ敻娼扮紒鎾寸€弬鍥︽
 */
<!-- 缁夘垰鍨庢禒璇插妞ょ敻娼?-->
<view class="container">
  <!-- 娴犺濮熺紒鐔活吀閸楋紕澧?-->
  <view class="stats-card">
    <view class="stats-item">
      <text class="stats-value">{{taskStats.total}}</text>
      <text class="stats-label">閹鎹㈤崝?/text>
    </view>
    <view class="stats-item">
      <text class="stats-value">{{taskStats.completed}}</text>
      <text class="stats-label">瀹告彃鐣幋?/text>
    </view>
    <view class="stats-item">
      <text class="stats-value">{{taskStats.pending}}</text>
      <text class="stats-label">鏉╂稖顢戞稉?/text>
    </view>
    <view class="stats-item">
      <text class="stats-value">{{taskStats.totalPoints}}</text>
      <text class="stats-label">閹崵袧閸?/text>
    </view>
  </view>
  
  <!-- 閺嶅洨顒烽崚鍥ㄥ床 -->
  <view class="tab-bar">
    <view wx:for="{{tabs}}" wx:key="key" 
          class="tab-item {{activeTab === item.key ? 'active' : ''}}"
          data-tab="{{item.key}}" 
          bindtap="onTabChange">
      {{item.name}}
    </view>
  </view>
  
  <!-- 娴犺濮熼崚妤勩€?-->
  <view class="content">
    <view wx:if="{{loading && taskList.length === 0}}" class="loading-state">
      <view class="loading-spinner"></view>
      <text>鍔犺浇涓?.</text>
    </view>
    
    <view wx:elif="{{taskList.length === 0 && !loading}}" class="empty-state">
      <image class="empty-icon" src="/images/empty-tasks.png"></image>
      <text>閺嗗倹妫ゆ禒璇插</text>
      <text class="empty-tip">韫囶偄骞撶€瑰本鍨氶崗鏈电铂娴犺濮熼崥?/text>
    </view>
    
    <view wx:else class="task-list">
      <view wx:for="{{taskList}}" wx:key="id" 
            class="task-item {{item.isExpired ? 'expired' : ''}}">
        <!-- 娴犺濮熸径鎾劥 -->
        <view class="task-header">
          <view class="task-title">
            <text class="task-name">{{item.name}}</text>
            <view wx:if="{{item.isExpired}}" class="task-tag expired-tag">瀹歌尪绻冮張?/view>
            <view wx:elif="{{item.status === 'completed' && !item.rewardReceived}}" class="task-tag reward-tag">瀵板懘顣崣?/view>
            <view wx:elif="{{item.status === 'claimed'}}" class="task-tag claimed-tag">瀹告煡顣崣?/view>
            <view wx:elif="{{item.status === 'completed'}}" class="task-tag completed-tag">瀹告彃鐣幋?/view>
          </view>
          <view class="task-points">+{{item.points}}缁夘垰鍨?/view>
        </view>
        
        <!-- 娴犺濮熼幓蹇氬牚 -->
        <view class="task-desc">{{item.description}}</view>
        
        <!-- 娴犺濮熸潻娑樺 -->
        <view class="task-progress">
          <view class="progress-info">
            <text>鏉╂稑瀹? {{item.currentCount || 0}}/{{item.targetCount || 0}}</text>
            <text>{{item.progress}}%</text>
          </view>
          <view class="progress-bar">
            <view class="progress-fill" style="width: {{item.progress}}%"></view>
          </view>
        </view>
        
        <!-- 娴犺濮熼弮鍫曟？ -->
        <view wx:if="{{item.expireTime}}" class="task-time">
          <text>閺堝鏅ラ張鐔诲殾: {{item.expireTime}}</text>
        </view>
        
        <!-- 娴犺濮熼幙宥勭稊 -->
        <view class="task-actions">
          <button wx:if="{{item.status === 'pending' && !item.isExpired}}" 
                  class="action-btn primary" 
                  data-id="{{item.id}}" 
                  bindtap="onTaskAction">
            {{item.actionText || '閸樿鐣幋?}}
          </button>
          
          <button wx:elif="{{item.status === 'completed' && !item.rewardReceived && !item.isExpired}}" 
                  class="action-btn reward" 
                  data-id="{{item.id}}" 
                  bindtap="onReceiveReward">
            妫板棗褰囨總鏍уС
          </button>
          
          <button wx:else 
                  class="action-btn detail" 
                  data-id="{{item.id}}" 
                  bindtap="onViewTaskDetail">
            閺屻儳婀呯拠锔藉剰
          </button>
        </view>
      </view>
    </view>
    
    <!-- 閸旂姾娴囬弴鏉戭樋 -->
    <view wx:if="{{loadingMore}}" class="loading-state">
      <view class="loading-spinner"></view>
      <text>閸旂姾娴囬弴鏉戭樋...</text>
    </view>
    
    <!-- 濞屸剝婀侀弴鏉戭樋閺佺増宓?-->
    <view wx:if="{{!hasMore && taskList.length > 0}}" class="no-more-data">
      濞屸剝婀侀弴鏉戭樋娴犺濮熸禍?    </view>
  </view>
</view>
