<!-- pages/category/category.wxml -->
<view class="category-container">
  <!-- 骨架屏 - 加载占位 -->
  <view class="skeleton-container" wx:if="{{showSkeleton}}">
    <view class="skeleton-left">
      <view class="skeleton-category-item" wx:for="[1,2,3,4,5]" wx:key="index"></view>
    </view>
    <view class="skeleton-right">
      <view class="skeleton-sub-category"></view>
      <view class="skeleton-article-item" wx:for="[1,2,3]" wx:key="index">
        <view class="skeleton-article-image"></view>
        <view class="skeleton-article-content">
          <view class="skeleton-article-title"></view>
          <view class="skeleton-article-meta"></view>
        </view>
      </view>
    </view>
  </view>

  <!-- 加载中状态 -->
  <view class="loading-container" wx:elif="{{loading && !error}}" aria-label="加载中">
    <view class="loading">
      <text>加载中...</text>
    </view>
  </view>

  <!-- 错误状态 -->
  <view class="error-container" wx:elif="{{error}}" aria-label="加载失败">
    <image src="/images/error.png" class="error-icon"></image>
    <text class="error-text">{{error}}</text>
    <button class="retry-button" bindtap="onRetry">重试</button>
  </view>

  <!-- 分类内容区域 -->
  <view wx:else class="category-content">
    <!-- 左侧分类列表 -->
    <view class="category-left" aria-label="主分类列表">
      <scroll-view scroll-y class="category-scroll">
        <view class="category-item {{currentCategoryId === item.id ? 'active' : ''}}" 
              wx:for="{{categories}}" 
              wx:key="id" 
              data-id="{{item.id}}" 
              bindtap="switchCategory" 
              aria-label="{{currentCategoryId === item.id ? '当前选中分类：' + item.name : item.name}}">
          <text>{{item.name}}</text>
        </view>
      </scroll-view>
    </view>

    <!-- 右侧内容区域 -->
    <view class="category-right">
      <!-- 子分类横向滚动 - 当有子分类时显示 -->
      <view class="sub-category-container" aria-label="子分类列表" wx:if="{{currentCategoryId > 0 && currentCategory}}">
        <scroll-view scroll-x class="sub-category-scroll" enable-flex>
          <view class="sub-category-item {{currentSubCategoryId === item.id ? 'active' : ''}}" 
                wx:for="{{currentCategory.children}}" 
                wx:key="id" 
                data-id="{{item.id}}" 
                bindtap="switchSubCategory" 
                aria-label="{{currentSubCategoryId === item.id ? '当前选中子分类：' + item.name : item.name}}">
            <text>{{item.name}}</text>
          </view>
        </scroll-view>
      </view>

      <!-- 文章列表 -->
      <view class="articles-container">
        <scroll-view scroll-y class="articles-scroll" bindscrolltolower="onReachBottom" enable-back-to-top>
          <!-- 文章列表项 - 通过API获取数据 -->
          <view class="article-item" 
                wx:for="{{articles}}" 
                wx:key="id" 
                data-id="{{item.id}}" 
                bindtap="goToArticleDetail" 
                aria-label="文章标题：{{item.title}}">
            <view class="article-image" wx:if="{{item.thumbnail || item.image}}">
              <image src="{{item.thumbnail || item.image}}" mode="aspectFill" aria-label="文章缩略图"></image>
            </view>
            <view class="article-content">
              <view class="article-title">{{item.title}}</view>
              <view class="article-meta">
                <text class="article-category">{{item.category?.name || '未分类'}}</text>
                <text class="article-date">{{item.date || ''}}</text>
                <text class="article-views">{{item.views || 0}} 浏览</text>
              </view>
            </view>
          </view>

          <!-- 加载更多状态 -->
          <view class="loading-more" wx:if="{{loadingMore}}">
            <text>加载更多...</text>
          </view>

          <!-- 没有更多数据状态 -->
          <view class="no-more" wx:if="{{!hasMore && articles.length > 0}}">
            <text>没有更多内容了</text>
          </view>

          <!-- 空状态 -->
          <view class="empty-state" wx:if="{{articles.length === 0 && !loading && !loadingMore}}">
            <image src="/images/empty.png" mode="aspectFit" class="empty-icon"></image>
            <text class="empty-text">暂无文章</text>
          </view>
        </scroll-view>
      </view>
    </view>
  </view>
</view>
