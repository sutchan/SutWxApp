# SUT寰俊灏忕▼搴忔彃浠?
[![GitHub release](https://img.shields.io/github/release/sutchan/SutWxApp.svg)](https://github.com/sutchan/SutWxApp/releases)
[![License](https://img.shields.io/github/license/sutchan/SutWxApp.svg)](https://github.com/sutchan/SutWxApp/blob/master/LICENSE)

**鐗堟湰鍙凤細1.0.3**
*鏈€鍚庢洿鏂版椂闂达細2024骞?鏈?5鏃?

SUT寰俊灏忕▼搴忔彃浠舵槸涓€涓负WordPress缃戠珯鎻愪緵寰俊灏忕▼搴忓鎺ュ姛鑳界殑鎻掍欢锛屾敮鎸佸唴瀹瑰睍绀恒€佺數鍟嗗姛鑳姐€佺敤鎴风鐞嗐€佹秷鎭帹閫佺瓑鍔熻兘銆傛湰鎻掍欢涓篧ordPress缃戠珯鎻愪緵浜嗗畬鏁寸殑API鎺ュ彛锛屼緵寰俊灏忕▼搴忚皟鐢ㄣ€?
## 鍔熻兘鐗规€?
- **鍐呭鍚屾**锛氬皢WordPress鏂囩珷銆侀〉闈€佸垎绫荤瓑鍐呭鍚屾鍒板井淇″皬绋嬪簭
- **鐢ㄦ埛绠＄悊**锛氭敮鎸佸井淇″皬绋嬪簭鐢ㄦ埛鐧诲綍銆佹敞鍐屻€佷釜浜轰俊鎭鐞嗙瓑
- **鐢靛晢鍔熻兘**锛氫笌WooCommerce闆嗘垚锛屾敮鎸佸晢鍝佸睍绀恒€佽喘鐗╄溅銆佽鍗曠鐞嗙瓑
- **寰俊鏀粯**锛氶泦鎴愬井淇℃敮浠樺姛鑳斤紝鏀寔灏忕▼搴忓唴鏀粯
- **娑堟伅鎺ㄩ€?*锛氭敮鎸佹ā鏉挎秷鎭€佽闃呮秷鎭€佸鏈嶆秷鎭瓑澶氱娑堟伅鎺ㄩ€佹柟寮?- **绉垎绯荤粺**锛氬唴缃Н鍒嗙郴缁燂紝鏀寔绛惧埌銆佽瘎璁恒€佸垎浜瓑琛屼负鑾峰彇绉垎
- **缂撳瓨绠＄悊**锛氬唴缃紦瀛樼郴缁燂紝鎻愬崌灏忕▼搴忚闂€熷害
- **鏁版嵁缁熻**锛氭彁渚涚敤鎴峰闀裤€侀攢鍞绛夋暟鎹粺璁″姛鑳?- **澶氳瑷€鏀寔**锛氭敮鎸佷腑鏂囩瓑澶氱璇█

## 鐜瑕佹眰

- WordPress 4.7 鎴栨洿楂樼増鏈?- PHP 5.6 鎴栨洿楂樼増鏈?- MySQL 5.6 鎴栨洿楂樼増鏈?- 寰俊灏忕▼搴忚处鍙?- 寰俊鏀粯鍟嗘埛鍙凤紙濡傞渶鐢靛晢鍔熻兘锛?- WooCommerce 3.0 鎴栨洿楂樼増鏈紙濡傞渶鐢靛晢鍔熻兘锛?
## 瀹夎鏂规硶

### 鏂规硶涓€锛氱洿鎺ヤ笂浼犲畨瑁?
1. 涓嬭浇鎻掍欢鐨刏IP鏂囦欢
2. 鐧诲綍WordPress鍚庡彴锛岃繘鍏?鎻掍欢" > "瀹夎鎻掍欢"
3. 鐐瑰嚮"涓婁紶鎻掍欢"锛岄€夋嫨涓嬭浇鐨刏IP鏂囦欢锛岀偣鍑?鐜板湪瀹夎"
4. 瀹夎瀹屾垚鍚庯紝鐐瑰嚮"鍚敤鎻掍欢"

### 鏂规硶浜岋細浣跨敤Git鍏嬮殕

```bash
cd /path/to/wordpress/wp-content/plugins
 git clone https://github.com/sutchan/SutWxApp.git sut-wechat-mini
```

鐒跺悗鍦╓ordPress鍚庡彴鍚敤鎻掍欢銆?
## 閰嶇疆璇存槑

1. 瀹夎骞跺惎鐢ㄦ彃浠跺悗锛屽湪WordPress鍚庡彴渚ц竟鏍忎細鍑虹幇"SUT寰俊灏忕▼搴?鑿滃崟椤?2. 鐐瑰嚮杩涘叆"鍩虹璁剧疆"椤甸潰锛屽～鍐欎互涓嬪繀瑕佷俊鎭細
   - 灏忕▼搴廇ppID锛氬湪寰俊鍏紬骞冲彴鑾峰彇
   - 灏忕▼搴廇ppSecret锛氬湪寰俊鍏紬骞冲彴鑾峰彇
   - 寰俊鏀粯鍟嗘埛鍙凤紙MCH_ID锛夛細濡傞渶鐢靛晢鍔熻兘锛屽湪寰俊鏀粯鍟嗘埛骞冲彴鑾峰彇
   - 寰俊鏀粯API瀵嗛挜锛氬湪寰俊鏀粯鍟嗘埛骞冲彴璁剧疆
3. 淇濆瓨璁剧疆鍚庯紝鎻掍欢灏嗚嚜鍔ㄥ垱寤烘墍闇€鐨勬暟鎹簱琛?4. 濡傞渶鍚敤娑堟伅鎺ㄩ€佸姛鑳斤紝璇烽厤缃浉搴旂殑娑堟伅妯℃澘ID

## API鎺ュ彛鏂囨。

鎻掍欢鎻愪緵浜嗕赴瀵岀殑API鎺ュ彛锛屼緵寰俊灏忕▼搴忚皟鐢ㄣ€傛墍鏈堿PI鎺ュ彛鐨勫熀纭€URL涓猴細`http://your-site.com/sut-wechat-mini-api/`

### 鍩虹API

- `ping`锛氭鏌PI杩炴帴鏄惁姝ｅ父
- `login`锛氱敤鎴风櫥褰?- `user/profile`锛氳幏鍙栫敤鎴蜂俊鎭?
### 鐢ㄦ埛鐩稿叧API

- `user/address/list`锛氳幏鍙栫敤鎴峰湴鍧€鍒楄〃
- `user/address/add`锛氭坊鍔犵敤鎴峰湴鍧€
- `user/address/update`锛氭洿鏂扮敤鎴峰湴鍧€
- `user/address/delete`锛氬垹闄ょ敤鎴峰湴鍧€
- `user/favorite/list`锛氳幏鍙栫敤鎴锋敹钘忓垪琛?- `user/favorite/add`锛氭坊鍔犳敹钘?- `user/favorite/delete`锛氬彇娑堟敹钘?- `user/signin`锛氱敤鎴风鍒?- `user/signin/history`锛氳幏鍙栫鍒板巻鍙?
### 鍐呭鐩稿叧API

- `content/articles`锛氳幏鍙栨枃绔犲垪琛?- `content/article/detail`锛氳幏鍙栨枃绔犺鎯?- `content/article/search`锛氭悳绱㈡枃绔?- `content/article/hot`锛氳幏鍙栫儹闂ㄦ枃绔?- `content/article/latest`锛氳幏鍙栨渶鏂版枃绔?- `content/categories`锛氳幏鍙栧垎绫诲垪琛?- `content/category/articles`锛氳幏鍙栧垎绫讳笅鐨勬枃绔?- `content/tags`锛氳幏鍙栨爣绛惧垪琛?- `content/tag/articles`锛氳幏鍙栨爣绛句笅鐨勬枃绔?- `content/pages`锛氳幏鍙栭〉闈㈠垪琛?- `content/page/detail`锛氳幏鍙栭〉闈㈣鎯?
### 鐢靛晢鐩稿叧API

锛堥渶瑕佸畨瑁呭苟鍚敤WooCommerce锛?
- `product/list`锛氳幏鍙栦骇鍝佸垪琛?- `product/detail`锛氳幏鍙栦骇鍝佽鎯?- `product/search`锛氭悳绱骇鍝?- `product/categories`锛氳幏鍙栦骇鍝佸垎绫?- `product/category/products`锛氳幏鍙栧垎绫讳笅鐨勪骇鍝?- `product/related`锛氳幏鍙栫浉鍏充骇鍝?- `product/featured`锛氳幏鍙栫壒鑹蹭骇鍝?- `product/sale`锛氳幏鍙栦績閿€浜у搧
- `cart/add`锛氭坊鍔犲晢鍝佸埌璐墿杞?- `cart/update`锛氭洿鏂拌喘鐗╄溅鍟嗗搧
- `cart/delete`锛氬垹闄よ喘鐗╄溅鍟嗗搧
- `cart/list`锛氳幏鍙栬喘鐗╄溅鍒楄〃
- `cart/clear`锛氭竻绌鸿喘鐗╄溅
- `order/create`锛氬垱寤鸿鍗?- `order/list`锛氳幏鍙栬鍗曞垪琛?- `order/detail`锛氳幏鍙栬鍗曡鎯?- `order/cancel`锛氬彇娑堣鍗?- `order/confirm`锛氱‘璁ゆ敹璐?- `payment/create`锛氬垱寤烘敮浠?- `payment/query`锛氭煡璇㈡敮浠樼粨鏋?- `payment/refund`锛氱敵璇烽€€娆?
## 寰俊灏忕▼搴忕寮€鍙?
涓轰簡浣跨敤鏈彃浠舵彁渚涚殑鍔熻兘锛屾偍闇€瑕佸紑鍙戝搴旂殑寰俊灏忕▼搴忋€傚皬绋嬪簭绔渶瑕佸疄鐜颁互涓嬪姛鑳斤細

1. **鐢ㄦ埛鐧诲綍**锛氳皟鐢╜login`鎺ュ彛鑾峰彇鐢ㄦ埛Token
2. **鍐呭灞曠ず**锛氳皟鐢ㄥ唴瀹圭浉鍏矨PI鑾峰彇鍜屽睍绀烘枃绔犮€侀〉闈㈢瓑鍐呭
3. **鐢靛晢鍔熻兘**锛氬疄鐜颁骇鍝佹祻瑙堛€佽喘鐗╄溅銆佽鍗曠鐞嗙瓑鍔熻兘
4. **鏀粯鍔熻兘**锛氳皟鐢ㄦ敮浠樼浉鍏矨PI瀹屾垚鏀粯娴佺▼
5. **娑堟伅璁㈤槄**锛氬疄鐜版秷鎭闃呭姛鑳斤紝鎺ユ敹鍚勭被閫氱煡

### 绀轰緥浠ｇ爜

浠ヤ笅鏄皬绋嬪簭绔皟鐢ˋPI鐨勭ず渚嬩唬鐮侊細

```javascript
// 璋冪敤鐧诲綍鎺ュ彛
function login() {
  wx.login({
    success: res => {
      if (res.code) {
        // 鍙戦€?code 鍒板悗绔崲鍙?openId, sessionKey, unionId
        wx.request({
          url: 'https://your-site.com/sut-wechat-mini-api/login',
          method: 'POST',
          data: {
            code: res.code
          },
          success: result => {
            if (result.data.code === 0) {
              // 淇濆瓨鐧诲綍鐘舵€?              wx.setStorageSync('token', result.data.data.token);
              wx.setStorageSync('userInfo', result.data.data.userInfo);
            }
          }
        })
      }
    }
  })
}

// 鑾峰彇鏂囩珷鍒楄〃
function getArticles(page = 1, category = 0) {
  return new Promise((resolve, reject) => {
    wx.request({
      url: 'https://your-site.com/sut-wechat-mini-api/content/articles',
      data: {
        page: page,
        category: category
      },
      header: {
        'Authorization': 'Bearer ' + wx.getStorageSync('token')
      },
      success: res => {
        if (res.data.code === 0) {
          resolve(res.data.data);
        } else {
          reject(res.data.message);
        }
      },
      fail: err => {
        reject(err);
      }
    })
  })
}
```

## 鏁版嵁搴撹〃缁撴瀯

鎻掍欢瀹夎鍚庝細鑷姩鍒涘缓浠ヤ笅鏁版嵁搴撹〃锛?
- `{wp_prefix}_sut_wechat_mini_users`锛氬瓨鍌ㄥ皬绋嬪簭鐢ㄦ埛淇℃伅
- `{wp_prefix}_sut_wechat_mini_addresses`锛氬瓨鍌ㄧ敤鎴峰湴鍧€淇℃伅
- `{wp_prefix}_sut_wechat_mini_favorites`锛氬瓨鍌ㄧ敤鎴锋敹钘忎俊鎭?- `{wp_prefix}_sut_wechat_mini_signin`锛氬瓨鍌ㄧ敤鎴风鍒颁俊鎭?- `{wp_prefix}_sut_wechat_mini_points`锛氬瓨鍌ㄧ敤鎴风Н鍒嗕俊鎭?- `{wp_prefix}_sut_wechat_mini_points_log`锛氬瓨鍌ㄧН鍒嗗彉鍔ㄦ棩蹇?- `{wp_prefix}_sut_wechat_mini_messages`锛氬瓨鍌ㄧ敤鎴锋秷鎭?- `{wp_prefix}_sut_wechat_mini_cart`锛氬瓨鍌ㄨ喘鐗╄溅淇℃伅
- `{wp_prefix}_sut_wechat_mini_orders`锛氬瓨鍌ㄨ鍗曚俊鎭?- `{wp_prefix}_sut_wechat_mini_order_items`锛氬瓨鍌ㄨ鍗曢」淇℃伅
- `{wp_prefix}_sut_wechat_mini_payments`锛氬瓨鍌ㄦ敮浠樹俊鎭?
## 缂撳瓨绠＄悊

鎻掍欢鍐呯疆浜嗙紦瀛樼郴缁燂紝鍙互缂撳瓨甯哥敤鐨凙PI鍝嶅簲鏁版嵁锛屾彁鍗囧皬绋嬪簭璁块棶閫熷害銆傜紦瀛橀粯璁ゆ湁鏁堟湡涓?灏忔椂锛屽彲鍦ㄨ缃〉闈㈣皟鏁淬€?
鎻掍欢浼氬湪浠ヤ笅鎯呭喌涓嬭嚜鍔ㄦ竻鐞嗙浉鍏崇紦瀛橈細
- 鏂囩珷/椤甸潰/浜у搧鏇存柊鏃?- 璁㈠崟鐘舵€佸彉鏇存椂
- 鐢ㄦ埛淇℃伅鏇存柊鏃?- 姣忔棩瀹氭椂娓呯悊杩囨湡缂撳瓨

## 鏃ュ織璁板綍

鎻掍欢鏀寔鏃ュ織璁板綍鍔熻兘锛屽彲浠ヨ褰旳PI璇锋眰銆侀敊璇俊鎭瓑銆傛棩蹇楀姛鑳介粯璁ゅ叧闂紝鍙湪璁剧疆椤甸潰鍚敤銆?
鏃ュ織鏂囦欢瀛樺偍鍦╜wp-content/plugins/sut-wechat-mini/logs/`鐩綍涓嬶紝鎸夋棩鏈熷懡鍚嶃€?
## 甯歌闂

### Q: 鍚敤鎻掍欢鍚庯紝鍦ㄥ悗鍙版病鏈夌湅鍒?SUT寰俊灏忕▼搴?鑿滃崟锛?A: 璇风‘璁ゆ偍鐨刉ordPress鐗堟湰鏄惁绗﹀悎瑕佹眰锛?.7鎴栨洿楂樼増鏈級锛屼互鍙婃偍鏄惁鍏锋湁绠＄悊鍛樻潈闄愩€?
### Q: 璋冪敤API鏃舵彁绀?鏈巿鏉?锛?A: 璇风‘璁ゆ偍鐨勫皬绋嬪簭AppID鍜孉ppSecret鏄惁姝ｇ‘閰嶇疆锛屽苟涓斿湪璋冪敤闇€瑕佹巿鏉冪殑API鏃讹紝鏄惁姝ｇ‘浼犻€掍簡Token銆?
### Q: 鏀粯鍔熻兘鏃犳硶浣跨敤锛?A: 璇风‘璁ゆ偍宸叉纭厤缃井淇℃敮浠樺晢鎴峰彿鍜孉PI瀵嗛挜锛屽苟涓旀偍鐨勫井淇″皬绋嬪簭宸插紑閫氭敮浠樺姛鑳姐€?
### Q: 鍐呭鏃犳硶鍚屾鍒板皬绋嬪簭锛?A: 璇风‘璁ゆ偍鐨勫唴瀹规槸鍚﹀凡鍙戝竷锛屽苟涓旀病鏈夎缃负绉佹湁銆?
## 寮€鍙戣鏄?
濡傛灉鎮ㄦ兂鎵╁睍鏈彃浠剁殑鍔熻兘锛屽彲浠ユ寜鐓т互涓嬫柟寮忚繘琛屽紑鍙戯細

1. **娣诲姞鏂扮殑API鎺ュ彛**锛氬湪`includes/api/class-sut-wechat-mini-api.php`鏂囦欢涓坊鍔犳柊鐨凙PI鏂规硶
2. **淇敼鍐呭灞曠ず**锛氬湪`includes/content/class-sut-wechat-mini-content.php`鏂囦欢涓慨鏀瑰唴瀹硅幏鍙栧拰鏍煎紡鍖栨柟娉?3. **璋冩暣鐢靛晢鍔熻兘**锛氬湪`includes/woocommerce/class-sut-wechat-mini-woocommerce.php`鏂囦欢涓皟鏁寸數鍟嗙浉鍏冲姛鑳?4. **娣诲姞鏂扮殑绠＄悊椤甸潰**锛氬湪`includes/admin/class-sut-wechat-mini-admin.php`鏂囦欢涓坊鍔犳柊鐨勭鐞嗛〉闈?
## 鐗堟潈淇℃伅

SUT寰俊灏忕▼搴忔彃浠舵槸鍩轰簬GPLv2璁稿彲璇佸紑婧愮殑杞欢銆?
## 鑱旂郴鏂瑰紡

濡傛灉鎮ㄥ湪浣跨敤杩囩▼涓亣鍒伴棶棰橈紝鎴栬€呮湁浠讳綍寤鸿锛屽彲浠ラ€氳繃浠ヤ笅鏂瑰紡鑱旂郴鎴戜滑锛?
- GitHub: [https://github.com/sutchan/SutWxApp](https://github.com/sutchan/SutWxApp)
- 閭: support@sutchan.com

## 鏇存柊鏃ュ織

### 1.0.0 (2023-xx-xx)
- 鍒濆鐗堟湰锛屽寘鍚墍鏈夊熀纭€鍔熻兘
- 鏀寔鍐呭鍚屾銆佺敤鎴风鐞嗐€佺數鍟嗗姛鑳姐€佹敮浠橀泦鎴愩€佹秷鎭帹閫併€佺Н鍒嗙郴缁熺瓑