﻿﻿﻿# 开发环境配置
## 目录

[TOC]

## 1. 文档基本信息

| 文档名称 | 开发环境配置 |
|---------|------------|
| 版本号 | 1.0.0 |
| 更新日期 | 2025-11-30 |
| 作者 | Sut |
| 描述 | 本文档详细介绍了SutWxApp项目的开发环境配置步骤，包括前端和后端环境的搭建、依赖安装和配置说明。 |

## 2. 开发环境要求

### 2.1 微信小程序开发环境
- **微信开发者工具**：最新稳定版
- **小程序AppID**：需要在微信公众平台注册获取
- **Node.js**：v16.0.0 或更高版本
- **npm**：v8.0.0 或更高版本

### 2.2 后端开发环境
- **Node.js**：v16.0.0 或更高版本
- **npm**：v8.0.0 或更高版本
- **MySQL**：v8.0 或更高版本
- **Redis**：v6.0 或更高版本
- **Git**：最新稳定版

## 3. 项目安装步骤

### 3.1 克隆项目

1. 打开终端或命令提示符
2. 执行以下命令克隆项目：

```bash
git clone https://github.com/sutchan/SutWxApp.git
```

3. 进入项目目录：

```bash
cd SutWxApp
```

### 3.2 安装依赖

1. 安装前端依赖：

```bash
cd SutWxApp
npm install
```

2. 安装后端依赖（如果有单独的后端目录）：

```bash
cd backend
npm install
```

## 4. 项目配置

### 4.1 小程序配置

1. 打开微信开发者工具
2. 导入项目，选择 `SutWxApp/SutWxApp` 目录
3. 在 `project.config.json` 中配置小程序AppID：

```json
{
  "description": "项目配置文件",
  "packOptions": {
    "ignore": []
  },
  "setting": {
    "urlCheck": true,
    "es6": true,
    "enhance": true,
    "postcss": true,
    "preloadBackgroundData": false,
    "minified": true,
    "newFeature": true,
    "coverView": true,
    "nodeModules": false,
    "autoAudits": false,
    "showShadowRootInWxmlPanel": true,
    "uglifyFileName": false,
    "checkInvalidKey": true,
    "checkSiteMap": true,
    "uploadWithSourceMap": true,
    "compileHotReLoad": false,
    "lazyloadPlaceholderEnable": false,
    "useMultiFrameRuntime": true,
    "useApiHook": true,
    "useApiHostProcess": true,
    "showES6CompileOption": false,
    "babelSetting": {
      "ignore": [],
      "disablePlugins": [],
      "outputPath": ""
    },
    "enableEngineNative": false,
    "useIsolateContext": true,
    "userConfirmedBundleSwitch": false,
    "packNpmManually": false,
    "packNpmRelationList": [],
    "minifyWXSS": true,
    "minifyWXML": true,
    "showShadowRootInWxmlPanel": true
  },
  "compileType": "miniprogram",
  "libVersion": "2.19.4",
  "appid": "your-app-id-here",
  "projectname": "SutWxApp",
  "debugOptions": {
    "hidedInDevtools": []
  },
  "isGameTourist": false,
  "condition": {
    "search": {
      "list": []
    },
    "conversation": {
      "list": []
    },
    "game": {
      "list": []
    },
    "miniprogram": {
      "list": []
    }
  }
}
```

4. 在 `app.js` 中配置API基础URL：

```javascript
App({
  globalData: {
    apiBaseUrl: 'https://your-api-server.com/api/v1'
  },
  onLaunch() {
    // 初始化逻辑
  }
  // ...其他配置
})
```

### 4.2 后端配置

1. 配置数据库连接：

```javascript
// config/database.js
module.exports = {
  host: 'localhost',
  port: 3306,
  user: 'root',
  password: 'your-password',
  database: 'sutwxapp',
  charset: 'utf8mb4'
};
```

2. 配置Redis连接：

```javascript
// config/redis.js
module.exports = {
  host: 'localhost',
  port: 6379,
  password: '',
  db: 0
};
```

3. 配置JWT密钥：

```javascript
// config/jwt.js
module.exports = {
  secret: 'your-jwt-secret-key',
  expiresIn: '7d'
};
```

## 5. 开发工具配置

### 5.1 VS Code配置

1. 安装以下扩展：
   - ESLint：代码检查
   - Prettier：代码格式化
   - Vetur：Vue.js支持（如果使用Vue）
   - WeChat Snippet：微信小程序代码片段
   - GitLens：Git增强

2. 配置VS Code设置：

```json
{
  "editor.formatOnSave": true,
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  },
  "prettier.singleQuote": true,
  "prettier.trailingComma": "es5",
  "prettier.tabWidth": 2,
  "vetur.format.defaultFormatter.js": "prettier",
  "vetur.format.defaultFormatter.html": "prettier"
}
```

### 5.2 微信开发者工具配置

1. 在微信开发者工具中开启以下设置：
   - 调试基础库：选择最新稳定版
   - ES6转ES5：开启
   - 增强编译：开启
   - 代码压缩：开启
   - 上传时自动压缩：开启

2. 配置域名白名单：
   - 登录微信公众平台
   - 进入小程序管理后台
   - 选择「开发」→「开发设置」
   - 在「服务器域名」中添加API服务器域名

## 6. 运行项目

### 6.1 运行前端项目

1. 打开微信开发者工具
2. 导入项目
3. 点击「编译」按钮运行项目
4. 点击「预览」按钮在手机上预览

### 6.2 运行后端项目

1. 进入后端目录
2. 执行以下命令启动后端服务：

```bash
npm start
```

3. 或者使用nodemon实现热重载：

```bash
npm run dev
```

## 7. 常见问题解决

### 7.1 API连接失败

如果小程序无法连接到API，请检查：
- 后端服务是否正常运行
- 小程序的API基础URL是否正确
- 服务器域名是否已添加到白名单
- 网络请求是否在request合法域名列表中

### 7.2 小程序编译失败

如果小程序编译失败，可能是因为：
- Node.js版本不符合要求（请使用v16.0.0或更高版本）
- 依赖未正确安装（请尝试删除node_modules并重新安装）
- 代码语法错误（请查看控制台错误信息）

### 7.3 页面加载缓慢

如果页面加载缓慢，可以尝试：
- 优化图片资源大小和格式
- 使用懒加载和分页加载
- 合理使用缓存机制
- 优化API响应时间

## 8. 开发规范

### 8.1 代码规范
- 使用ESLint和Prettier进行代码检查和格式化
- 遵循JavaScript ES6+语法
- 组件化开发，合理拆分组件
- 代码注释清晰，便于维护

### 8.2 Git规范
- 遵循Git Flow工作流
- 提交信息清晰明了，使用语义化提交
- 定期拉取和推送代码
- 分支命名规范：feature/xxx、bugfix/xxx、hotfix/xxx

## 9. 文档更新记录

| 版本号 | 更新日期 | 更新内容 | 作者 |
|-------|---------|---------|------|
| 1.0.0 | 2025-11-30 | 初始版本，包含开发环境配置的基本步骤 | Sut |
| 1.0.1 | 2025-11-30 | 修复了部分配置示例的格式问题 | Sut |
| 1.0.2 | 2025-11-30 | 添加了VS Code配置和Git规范 | Sut |