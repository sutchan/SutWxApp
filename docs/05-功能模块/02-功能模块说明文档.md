# 功能模块说明文档

## 1. 概述
本文档汇总 SutWxApp 的主要功能模块、依赖关系、数据流与接口约定，作为开发与协作的总览参考。

## 2. 模块清单
- 用户与认证：注册/登录、资料、权限、Token 管理。
- 内容与文章：文章列表/详情、评论、收藏、分享。
- 商品与分类：商品详情、规格、库存、分类管理。
- 购物车：增删改查、价格计算、优惠叠加策略。
- 订单管理：创建、支付、发货、售后、退款。
- 支付中心：微信支付、支付状态回调、对账。
- 积分系统：获取/消耗/抵扣/过期与风控（见《积分系统功能说明》）。
- 会员体系：等级、权益、成长值、升级规则。
- 消息中心：站内消息、模板消息、订阅消息。
- 活动运营：优惠券、满减、秒杀、拼团、抽奖。
- 客服与工单：在线客服、问题工单、反馈处理。
- 多语言支持：国际化 `.po/.pot` 字符串维护与一致性。

## 3. 依赖关系（示例）
- 订单依赖：商品、库存、价格、优惠、支付、积分。
- 支付依赖：订单、用户、风控、消息通知。
- 积分依赖：订单事件、任务中心、活动配置、会员体系。
- 会员依赖：积分、订单、活动。

## 4. 数据流与事件
- 下单：购物车→订单→支付→发货→完成→（积分发放/会员成长）。
- 售后：退款→库存回滚→积分回退/冻结→消息通知。
- 任务：用户行为事件→校验限频→发放积分/权益→记录流水。

## 5. 接口约定
统一参考 `docs/03-开发者指南/03-API接口文档.md`，各模块应：
- 使用 RESTful 设计、统一响应格式与错误码。
- 明确认证与权限边界（RBAC）。
- 提供分页、过滤、排序能力。
- 关键写操作需幂等与审计日志。

## 6. 配置与开关
- 运营开关：活动、券、任务、积分抵扣、消息发送。
- 策略配置：积分倍率、支付限额、风控策略、黑白名单。
- 灰度发布：按用户/地区/版本进行开关控制。

## 7. 性能与可靠性
- 缓存：热点数据缓存、列表分页缓存、限频状态缓存。
- 异步：消息与事件队列、批处理任务（过期、清理）。
- 可靠性：事务/锁/幂等、重试与告警、降级策略。

## 8. 测试建议
- 单元测试：服务与工具函数、规则校验。
- 集成测试：下单/支付/售后闭环、积分变更与回退。
- 接口测试：认证、权限、错误码与边界。
- 性能测试：并发下单/支付、批处理任务压力测试。

## 9. 风险与边界
- 金融相关：支付/退款严格对账、异常回退。
- 风控：积分刷取、防套利、设备指纹与限频。
- 数据一致性：并发扣减、库存与积分一致性治理。

## 10. 版本演进（示例）
- v1：核心电商闭环与基础积分。
- v2：会员权益、活动矩阵与消息中心。
- v3：性能扩展与风控体系完善。
