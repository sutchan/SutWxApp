# 系统配置

<!--
文件名: 02-系统配置.md
版本号: 1.0.0
更新日期: 2025-11-30
作者: Sut
描述: 系统配置方法和参数说明
-->

## 目录

[TOC]

## 1. 概述

### 1.1 文档目的

本文档旨在指导系统管理员完成SutWxApp项目的系统配置，包括环境变量配置、数据库配置、Redis配置等。

### 1.2 适用对象

- 系统管理员
- 运维人员

## 2. 配置文件

### 2.1 环境变量配置

项目使用.env文件存储环境变量，配置示例如下：

```dotenv
# 服务器配置
PORT=3000
HOST=localhost
NODE_ENV=development

# 数据库配置
DB_HOST=localhost
DB_PORT=3306
DB_USER=sutwxapp
DB_PASSWORD=password
DB_NAME=sutwxapp

# Redis配置
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# 微信小程序配置
APPID=wx1234567890abcdef
APPSECRET=1234567890abcdef1234567890abcdef

# JWT配置
JWT_SECRET=your-secret-key
JWT_EXPIRES_IN=7d

# 文件上传配置
UPLOAD_PATH=./uploads
MAX_FILE_SIZE=5242880
```

### 2.2 配置项说明

| 配置项 | 类型 | 默认值 | 说明 |
|-------|------|-------|------|
| PORT | 数字 | 3000 | 服务器端口 |
| HOST | 字符串 | localhost | 服务器主机 |
| NODE_ENV | 字符串 | development | 运行环境（development/production/test） |
| DB_HOST | 字符串 | localhost | 数据库主机 |
| DB_PORT | 数字 | 3306 | 数据库端口 |
| DB_USER | 字符串 | sutwxapp | 数据库用户名 |
| DB_PASSWORD | 字符串 | password | 数据库密码 |
| DB_NAME | 字符串 | sutwxapp | 数据库名称 |
| REDIS_HOST | 字符串 | localhost | Redis主机 |
| REDIS_PORT | 数字 | 6379 | Redis端口 |
| REDIS_PASSWORD | 字符串 | | Redis密码 |
| APPID | 字符串 | | 微信小程序APPID |
| APPSECRET | 字符串 | | 微信小程序APPSECRET |
| JWT_SECRET | 字符串 | | JWT密钥 |
| JWT_EXPIRES_IN | 字符串 | 7d | JWT过期时间 |
| UPLOAD_PATH | 字符串 | ./uploads | 文件上传路径 |
| MAX_FILE_SIZE | 数字 | 5242880 | 最大文件大小（字节） |

## 3. 配置步骤

### 3.1 复制配置文件

1. 复制.env.example文件为.env：
   ```bash
   cp .env.example .env
   ```

### 3.2 编辑配置文件

1. 使用文本编辑器编辑.env文件：
   ```bash
   nano .env
   ```

2. 根据实际情况修改配置项的值

### 3.3 重启服务

配置修改后，需要重启服务使配置生效：
```bash
npm run server
```

## 4. 配置验证

### 4.1 验证数据库连接

1. 启动服务后，查看日志输出
2. 如果数据库连接成功，会输出：
   ```
   Database connected successfully
   ```

### 4.2 验证Redis连接

1. 启动服务后，查看日志输出
2. 如果Redis连接成功，会输出：
   ```
   Redis connected successfully
   ```

### 4.3 验证微信小程序配置

1. 在微信开发者工具中预览项目
2. 尝试登录，如果登录成功，说明微信小程序配置正确

## 5. 常见问题

### 5.1 配置项错误

**问题**：服务启动失败，提示配置项错误

**解决方案**：
1. 检查.env文件中的配置项是否正确
2. 检查配置项的格式是否正确（如数字、字符串等）
3. 检查配置项是否缺少

### 5.2 数据库连接失败

**问题**：服务启动失败，提示数据库连接失败

**解决方案**：
1. 检查数据库服务是否正常运行
2. 检查DB_HOST、DB_PORT、DB_USER、DB_PASSWORD、DB_NAME配置是否正确
3. 检查数据库用户是否有足够的权限

### 5.3 Redis连接失败

**问题**：服务启动失败，提示Redis连接失败

**解决方案**：
1. 检查Redis服务是否正常运行
2. 检查REDIS_HOST、REDIS_PORT、REDIS_PASSWORD配置是否正确

## 6. 相关链接

- [环境搭建.md](./01-环境搭建.md)
- [权限管理.md](./03-权限管理.md)
